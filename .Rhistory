div$tPpersite = div$tP/div$numSites
pdf("XCS_diversity_stats.pdf")
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
dev.off()
summary(div)
pdf("XCS_diversity_stats.pdf")
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-W", main = "")
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
dev.off()
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
barplot(plotSFS)
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
dev.off()
pdf("XCS_diversity_stats.pdf")
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-P", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
dev.off()
summary(div)
Tajd <- div$tPpersite - div$tWpersite
summary(Tajd)
setwd("/Users/chege/Desktop/Spring 2020/SCHOOL/Genomics Class/thetas")
list.files()
SFS <- scan("XCS_outfold.sfs")
sumSFS <- sum(SFS)
pctPoly = 100*(1-(SFS[1]/sumSFS))
plotSFS <- SFS[-c(1,length(SFS))]
barplot(plotSFS)
div <- read.table("XCS_folded_allsites.thetas.idx.pestPG")
colnames(div) = c("window","chrname","wincenter","tW","tP","tF","tH","tL","tajD","fulif","fuliD","fayH","zengsE","numSites")
div$tWpersite = div$tW/div$numSites
div$tPpersite = div$tP/div$numSites
pdf("XCS_diversity_stats.pdf")
par(mfrow=c(2,2))
hist(div$tWpersite, col = "gray", xlab = "Theta-W", main = "")
hist(div$tPpersite, col = "gray", xlab = "Theta-P", main = "")
hist(div$tajD, col = "gray", xlab = "Tajima's D", main = "")
barplot(plotSFS)
dev.off()
summary(div)
Tajd <- div$tPpersite - div$tWpersite
summary(Tajd)
install.packages("tximportData")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.10")
library(tximportData)
library(tximport)
install.packages("tximport")
library(installr)
updateR()
BiocManager::install("tximport")
BiocManager::install("tximportdata")
BiocManager::install("tximportData")
library(DESeq2)
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
library(ggpubr)
library(readr)
install.packages("DESeq2")
BiocManager::install("DESeq2")
BiocManager::install("dplyr")
BiocManager::install("tidyr")
BiocManager::install("ggplot2")
BiocManager::install("scales")
BiocManager::install("ggpubr")
BiocManager::install("readr")
library(tximportData)
library(tximport)
#locate the directory containing the files.
dir <- "/data/project_data/RS_RNASeq/salmon/"
install.packages("wesanderson")
source('~/Desktop/Spring 2020/SCHOOL/Genomics Class/RS_counts_samples/wedclass.R', echo=TRUE)
## Set your working directory
setwd("YOURWORKINGDIRECTORY")
setwd("YOURWORKINGDIRECTORY")
setwd("~/Desktop/Spring 2020/SCHOOL/Genomics Class/RS_counts_samples")
## Import the libraries that we're likely to need in this session
library(DESeq2)
library(dplyr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggplot2)
library(scales)
library(ggpubr)
library(wesanderson)
library(vsn)  ### First: BiocManager::install("vsn") AND BiocManager::install("hexbin")
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
library(ggplot2)
library(scales)
library(ggpubr)
library(wesanderson)
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
head(countsTable)
dim(countsTable)
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
head(countsTable)
dim(countsTable)
countsTableRound <- round(countsTable) # Need to round because DESeq wants only integers
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
head(countsTable)
dim(countsTable)
countsTableRound <- round(countsTable) # Need to round because DESeq wants only integers
head(countsTableRound)
## Import the samples description table - links each sample to factors of the experimental design.
# Need the colClasses otherwise imports "day" as numeric which DESeq doesn't like, coula altneratively change to d0, d5, d10
conds <- read.delim("RS_samples.txt", header=TRUE, stringsAsFactors = TRUE, row.names=1, colClasses=c('factor', 'factor', 'factor', 'factor'))
head(conds)
dim(conds)
## Let's see how many reads we have from each sample:
colSums(countsTableRound)
mean(colSums(countsTableRound))
barplot(colSums(countsTableRound), las=3, cex.names=0.5,names.arg = substring(colnames(countsTableRound),1,13))
abline(h=mean(colSums(countsTableRound)), col="blue", lwd =2)
#average number of counts per gene
mean(rowSums(countsTableRound))
median(rowSums(countsTableRound))
# avergae number of counts per gene per sample
apply(countsTableRound,2,mean)
## Create a DESeq object and define the experimental design here with the tilde
dds <- DESeqDataSetFromMatrix(countData = countsTableRound,colData = conds, design = ~ pop + day + treatment)
dim(dds)
dds <- dds[rowSums(counts(dds))>76]
dim(dds)
dds <- dds[rowSums(counts(dds))>760]
dim(dds)
dds <- DESeq(dds)
resultsNames(dds)
source('~/Desktop/Spring 2020/SCHOOL/Genomics Class/RS_counts_samples/wedclass.R', echo=TRUE)
## Create a DESeq object and define the experimental design here with the tilde
dds <- DESeqDataSetFromMatrix(countData = countsTableRound, colData = conds, design = ~ climate + day + treatment)
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
head(countsTable)
dim(countsTable)
countsTableRound <- round(countsTable) # Need to round because DESeq wants only integers
head(countsTableRound)
## Import the samples description table - links each sample to factors of the experimental design.
# Need the colClasses otherwise imports "day" as numeric which DESeq doesn't like, coula altneratively change to d0, d5, d10
conds <- read.delim("RS_samples.txt", header=TRUE, stringsAsFactors = TRUE, row.names=1, colClasses=c('factor', 'factor', 'factor', 'factor'))
head(conds)
dim(conds)
## Let's see how many reads we have from each sample:
colSums(countsTableRound)
mean(colSums(countsTableRound))
barplot(colSums(countsTableRound), las=3, cex.names=0.5,names.arg = substring(colnames(countsTableRound),1,13))
abline(h=mean(colSums(countsTableRound)), col="blue", lwd =2)
#average number of counts per gene
mean(rowSums(countsTableRound))
median(rowSums(countsTableRound))
# avergae number of counts per gene per sample
apply(countsTableRound,2,mean)
## Create a DESeq object and define the experimental design here with the tilde
dds <- DESeqDataSetFromMatrix(countData = countsTableRound, colData = conds, design = ~ climate + day + treatment)
dim(dds)
dds <- dds[rowSums(counts(dds))>760]
dim(dds)
dds <- DESeq(dds)
resultsNames(dds)
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [3] "pop_CAM_02_vs_ASC_06" "pop_ESC_01_vs_ASC_06"
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [3] "pop_CAM_02_vs_ASC_06" "pop_ESC_01_vs_ASC_06"
# [5] "pop_JAY_02_vs_ASC_06" "pop_KAN_04_vs_ASC_06"
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [3] "pop_CAM_02_vs_ASC_06" "pop_ESC_01_vs_ASC_06"
# [5] "pop_JAY_02_vs_ASC_06" "pop_KAN_04_vs_ASC_06"
# [7] "pop_LOL_02_vs_ASC_06" "pop_MMF_13_vs_ASC_06"
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [3] "pop_CAM_02_vs_ASC_06" "pop_ESC_01_vs_ASC_06"
# [5] "pop_JAY_02_vs_ASC_06" "pop_KAN_04_vs_ASC_06"
# [7] "pop_LOL_02_vs_ASC_06" "pop_MMF_13_vs_ASC_06"
# [9] "pop_NOR_02_vs_ASC_06" "pop_XBM_07_vs_ASC_06"
# [1] "Intercept"            "pop_BRU_05_vs_ASC_06"
# [3] "pop_CAM_02_vs_ASC_06" "pop_ESC_01_vs_ASC_06"
# [5] "pop_JAY_02_vs_ASC_06" "pop_KAN_04_vs_ASC_06"
# [7] "pop_LOL_02_vs_ASC_06" "pop_MMF_13_vs_ASC_06"
# [9] "pop_NOR_02_vs_ASC_06" "pop_XBM_07_vs_ASC_06"
# [11] "day_10_vs_0"          "day_5_vs_0"
# Order and list and summarize results from specific contrasts
##### Data visualization #####
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Order and list and summarize results from specific contrasts
# Here you set your adjusted p-value cutoff, can make summary tables of the number of genes differentially expressed (up- or down-regulated) for each contrast
res <- results(dds, alpha = 0.05)
res <- res[order(res$padj),]
head(res)
summary(res)
res_treatCD <- results(dds, name = "treatment_D_vs_C", alpha=0.05)
res_treatCD <- results(dds, alpha = 0.05)
res_treatCD <- res[order(res$padj),]
head(res_treatCD)
summary(res_treatCD)
##### Data visualization #####
# MA plot
plotMA(res_treatCD,ylim=c(-3,3))
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"), returnData=TRUE)
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"), returnData=TRUE)
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# PCA
vst <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"), returnData=TRUE)
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
summary(res_treatCD)
##### Data visualization #####
# MA plot
plotMA(res_treatCD,ylim=c(-3,3))
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"), returnData=TRUE)
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd,intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
## Import the counts matrix
countsTable <- read.table("RS_cds2kb_countsMatrix.txt", header=TRUE, row.names=1)
head(countsTable)
dim(countsTable)
countsTableRound <- round(countsTable) # Need to round because DESeq wants only integers
head(countsTableRound)
## Import the samples description table - links each sample to factors of the experimental design.
# Need the colClasses otherwise imports "day" as numeric which DESeq doesn't like, coula altneratively change to d0, d5, d10
conds <- read.delim("RS_samples.txt", header=TRUE, stringsAsFactors = TRUE, row.names=1, colClasses=c('factor', 'factor', 'factor', 'factor'))
head(conds)
dim(conds)
## Let's see how many reads we have from each sample:
colSums(countsTableRound)
mean(colSums(countsTableRound))
barplot(colSums(countsTableRound), las=3, cex.names=0.5,names.arg = substring(colnames(countsTableRound),1,13))
abline(h=mean(colSums(countsTableRound)), col="blue", lwd =2)
#average number of counts per gene
mean(rowSums(countsTableRound))
median(rowSums(countsTableRound))
# avergae number of counts per gene per sample
apply(countsTableRound,2,mean)
## Create a DESeq object and define the experimental design here with the tilde
dds <- DESeqDataSetFromMatrix(countData = countsTableRound, colData = conds, design = ~ climate + day + treatment)
dim(dds)
dds <- dds[rowSums(counts(dds))>760]
dim(dds)
dds <- DESeq(dds)
resultsNames(dds)
# Order and list and summarize results from specific contrasts
# Here you set your adjusted p-value cutoff, can make summary tables of the number of genes differentially expressed (up- or down-regulated) for each contrast
res <- results(dds, alpha = 0.05)
res <- res[order(res$padj),]
head(res)
summary(res)
res_treatCD <- results(dds, name = "treatment_D_vs_C", alpha=0.05)
res_treatCD <- results(dds, alpha = 0.05)
res_treatCD <- res[order(res$padj),]
head(res_treatCD)
summary(res_treatCD)
##### Data visualization #####
# MA plot
plotMA(res_treatCD,ylim=c(-3,3))
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd,intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
vsd <- vst(DDS1,blind=FALSE)
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"),returnData=TRUE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
percentVar <- round(100*attr(data, "percentVar"))
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
percentVar <- round
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# PCA
vsd <- vst(dds, blind=FALSE)
data <- plotPCA(vsd, intgroup=c("climate","treatment","day"),returnData=TRUE)
percentVar <- round(100 * attr(data, "percentVar"))
data$treatment <- factor(data$treatment, levels=c("C","H","D"), labels = c("C","H","D"))
data$day <- factor(data$day, levels=c("0","5","10"), labels = c("0","5","10"))
ggplot(data, aes(PC1, PC2, color=climate, shape=treatment)) +
geom_point(size=4, alpha=0.85) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
theme_minimal()
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10426407g0030", intgroup = (c("treatment","climate")), returnData=TRUE)
d
p <-ggplot(d, aes(x=climate, y=count, shape=climate, colour = treatment)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("CW","HD"))
p
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10426002g0010", intgroup = (c("treatment","climate")), returnData=TRUE)
d
p <-ggplot(d, aes(x=climate, y=count, shape=climate, colour = treatment)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("CW","HD"))
p
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10426002g0010", intgroup = (c("treatment","climate")), returnData=TRUE)
d
p <-ggplot(d, aes(x=treatment, y=count, shape=climate, colour = treatment)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("CW","HD"))
p
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p
# Heatmap of top 20 genes sorted by pvalue
# Heatmap of top 20 genes sorted by pvalue
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10426002g0010", intgroup = (c("treatment","climate")), returnData=TRUE)
d
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("C","H","D"))
p
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10257300g0010", intgroup = (c("treatment","climate","day")), returnData=TRUE)
d
p <-ggplot(d, aes(x=treatment, y=count, color=day, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("C","H","D"))
p
p <-ggplot(d, aes(x=treatment, y=count, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p
# Counts of specific top gene! (important validatition that the normalization, model is working)
d <-plotCounts(dds, gene="MA_10257300g0010", intgroup = (c("treatment","climate","day")), returnData=TRUE)
d
p <-ggplot(d, aes(x=treatment, y=count, color=day, shape=climate)) +
theme_minimal() + theme(text = element_text(size=20), panel.grid.major=element_line(colour="grey"))
p <- p + geom_point(position=position_jitter(w=0.3,h=0), size=3) +
scale_x_discrete(limits=c("C","H","D"))
p
# Heatmap of top 20 genes sorted by pvalue
library(pheatmap)
topgenes <- head(rownames(res_treatCD),20)
mat <- assay(vsd)[topgenes,]
install.packages("pheatmap")
# Heatmap of top 20 genes sorted by pvalue
library(pheatmap)
topgenes <- head(rownames(res_treatCD),20)
mat <- assay(vsd)[topgenes,]
mat <- mat - rowMeans(mat)
df <- as.data.frame(colData(dds)[,c("treatment","climate")])
pheatmap(mat, annotation_col=df)
# Heatmap of top 20 genes sorted by pvalue
library(pheatmap)
topgenes <- head(rownames(res_treatCD),20)
mat <- assay(vsd)[topgenes,]
mat <- mat - rowMeans(mat)
df <- as.data.frame(colData(dds)[,c("treatment","climate","day")])
pheatmap(mat, annotation_col=df)
day10countstable <- countsTableRound %>% select(contains("10"))
dim(day10countstable)
conds10<- subset(conds, day=="10")
dim(conds10)
